/* empty css                  */import{v as Ye}from"./el-loading.0e11b51e.js";import{E as Ze}from"./el-tree.a831a800.js";import{E as Ge,a as Qe}from"./el-tag.9c1a7e8f.js";import{E as ea,b as aa,d as oa}from"./el-input.8287fb26.js";import"./el-tooltip.704dbad3.js";import{E as la}from"./el-scrollbar.d9e482b0.js";import{E as sa,a as ta}from"./el-breadcrumb-item.95342798.js";import{E as na}from"./el-divider.abf729b4.js";import{E as ra}from"./el-link.3fc7c806.js";import{b as da,q as ia,d as ve,u as ua,o as f,g as m,n as U,a as P,j as Q,h as g,C as t,D as ca,_ as fa,k as u,t as v,p as pa,Y as ma,r,ay as M,Z as ha,cy as va,$ as ee,F as _a,W as ga,aC as ya,S as wa,M as o,w as l,aA as x,aE as Ca,aD as ba,aB as p,cl as ka,ak as Sa,bX as Ea,aj as he,az as ae,V as _,cw as Fa,cz as Da,cA as Ta,ck as Ia,f as Va}from"./index.57de75bb.js";import{s as k}from"./index.3b7b66eb.js";import"./index.6b5203ca.js";import"./debounce.4be17b9e.js";import"./index.4638f3e1.js";const Pa=da({header:{type:String,default:""},footer:{type:String,default:""},bodyStyle:{type:ia([String,Object,Array]),default:""},bodyClass:String,shadow:{type:String,values:["always","hover","never"],default:"always"}}),xa=ve({name:"ElCard"}),Ua=ve({...xa,props:Pa,setup(_e){const y=ua("card");return(d,W)=>(f(),m("div",{class:U([P(y).b(),P(y).is(`${d.shadow}-shadow`)])},[d.$slots.header||d.header?(f(),m("div",{key:0,class:U(P(y).e("header"))},[Q(d.$slots,"header",{},()=>[u(v(d.header),1)])],2)):g("v-if",!0),t("div",{class:U([P(y).e("body"),d.bodyClass]),style:ca(d.bodyStyle)},[Q(d.$slots,"default")],6),d.$slots.footer||d.footer?(f(),m("div",{key:1,class:U(P(y).e("footer"))},[Q(d.$slots,"footer",{},()=>[u(v(d.footer),1)])],2)):g("v-if",!0)],2))}});var Na=fa(Ua,[["__file","card.vue"]]);const Ra=pa(Na);const $a={"element-loading-text":"\u52A0\u8F7D\u4E2D...",class:"pan-share-content"},Oa={class:"pan-share-header-content"},za={class:"pan-share-header-content-wrapper"},Ba={key:0,class:"pan-share-header-user-info-content"},Aa={key:1,class:"pan-share-header-button-content"},La={class:"pan-share-list-content"},Ma={class:"pan-share-list-wrapper"},Wa={key:0,slot:"header",class:"pan-share-list-card-header"},ja={class:"pan-share-list-card-header-share-info-content"},Ha={class:"pan-share-list-card-header-share-info"},Ka={class:"pan-share-list-card-header-time"},Ja={class:"pan-share-list-card-header-create-date"},qa={class:"pan-share-list-card-header-expire-date"},Xa={class:"pan-share-list-card-button-group"},Ya={key:1,class:"pan-share-list-card-error-message"},Za={key:2,class:"pan-share-list-card-operate-content"},Ga={class:"pan-share-list-card-operate-bread-crumb"},Qa=["onClick"],eo={key:3,class:"pan-share-list"},ao=["onClick"],oo={style:{cursor:"pointer"}},lo={class:"file-operation-content"},so={class:"dialog-footer"},to={class:"pan-share-code-content"},no={class:"pan-share-code-wrapper"},ro={class:"tree-content"},io={class:"custom-tree-node"},uo={class:"dialog-footer"},Io={__name:"index",setup(_e){const y=ma(),d=r(null),W=r(null),j=r(null),ge=r(null),oe=r(null),le=r(null),ye=()=>{oe.value.focus()},we=()=>{d.value.resetFields()},Ce=()=>{le.value.focus()},be=()=>{j.value.resetFields()},ke=M({username:[{validator:(a,e,s)=>{if(!_.checkUsername(e)){s("Please enter a 6-16 digit username containing only numbers and letters");return}s()},trigger:"blur"}],password:[{validator:(a,e,s)=>{if(!_.checkPassword(e)){s("Please enter a password of 8-16 digits");return}s()},trigger:"blur"}]}),Se=M({shareCode:[{required:!0,message:"Please enter the share code",trigger:"blur"}]}),w=M({username:"",password:""}),c=r(!1),N=r(""),S=r(!1),E=r(!1),F=r(!1),R=M({shareCode:""}),$=r(""),D=r(!1),H=r([]),Ee=r(window.innerHeight-300),h=r([]),se=r(!0),te=r(""),K=r(""),T=r([{id:"-1",name:"All Files"}]),J=r([]),b=r(!1),O=r(void 0),Fe=a=>{let e=a.shareUserInfoVO.username,s=a.shareName;$.value=e+"shares"+s,te.value=a.createTime,a.shareDay===0?K.value="permanently valid":K.value=a.shareEndTime,H.value=a.rpanUserFileVOList},q=()=>y.params.shareId,ne=()=>{D.value=!0},De=()=>{k.getSimpleShareDetail({shareId:q()},a=>{a.code===0?(F.value=!0,$.value=a.data.shareUserInfoVO.username+"Share: "+a.data.shareName):(F.value=!1,ne())})},X=()=>{k.getShareDetail(a=>{a.code===0?Fe(a.data):a.code===4?De():ne()})},z=()=>{x.infoWithoutPageJump(a=>{a.code===0?(N.value=a.data.username,E.value=!0):(N.value="",E.value=!1)})},B=()=>{S.value=!0},Te=()=>{Ca.confirm("Sure you want to log out?","Notice",{confirmButtonText:"Confirm",cancelButtonText:"Cancel",type:"warning"}).then(()=>{x.exit(()=>{ba(),E.value=!1,N.value=""},a=>{p.error(a.message)})})},Y=async()=>{await d.value.validate((a,e)=>{a&&(c.value=!0,x.login({username:w.username,password:w.password},s=>{c.value=!1,Fa(s.data),S.value=!1,z()},s=>{c.value=!1,p.error(s.message)}))})},Ie=()=>{window.location.href="/"},re=async()=>{await j.value.validate(a=>{a&&(c.value=!0,k.checkShareCode({shareId:q(),shareCode:R.shareCode},e=>{e.code===0?(c.value=!1,Da(e.data),F.value=!1,X()):(c.value=!1,p.error(e.message))}))})},Ve=a=>{h.value=a},Pe=(a,e,s,C)=>{_.showOperation(s)},xe=(a,e,s,C)=>{_.hiddenOperation(s)},Ue=a=>{a.folderFlag===1&&Ne(a)},Ne=a=>{T.value.push({id:a.fileId,name:a.filename}),de(a.fileId)},de=a=>{k.getShareFiles({parentId:a},e=>{e.code===0?H.value=e.data:window.location.reload()})},Re=a=>{if(a==="-1")T.value=[{id:"-1",name:"All Files"}],X();else{let e=new Array;T.value.some(s=>{if(e.push(s),s.id===a)return!0}),T.value=e,de(a)}},$e=()=>{if(!h.value||h.value.length===0){p.error("Please select a file to download");return}for(let a=0,e=h.value.length;a<e;a++)if(h.value[a].folderFlag===1){p.error("Folders are not supported for download");return}ie(h.value)},ie=(a,e)=>{e||(e=0),a.length!==e&&setTimeout(function(){ue(a[e]),e++,ie(a,e)},500)},ue=a=>{if(a.folderFlag===1){p.error("Folders are not supported for download");return}x.infoWithoutPageJump(e=>{e.code===0?k.getSimpleShareDetail({shareId:q()},s=>{if(s.code===0){let C=_.getUrlPrefix()+"/share/file/download?fileId="+_.handleId(a.fileId)+"&shareToken="+Ta()+"&authorization="+Ia(),I=a.filename,i=document.createElement("a");i.style.display="none",i.href=C,i.setAttribute("download",I),document.body.appendChild(i),i.click(),document.body.removeChild(i)}else window.location.reload()}):(z(),B())})},Oe=()=>{J.value=new Array,O.value=void 0},ze=()=>{ka.getFolderTree(a=>{J.value=a.data},a=>{p.error(a.message)})},Be=()=>{c.value=!0;let a=W.value.getCurrentNode();if(!a){p.error("Please select a folder"),c.value=!1;return}Ae(a.id)},ce=a=>{if(a)O.value=a;else if(!h.value||h.value.length===0){p.error("Please select a file to save");return}x.infoWithoutPageJump(e=>{e.code===0?b.value=!0:B()})},Ae=a=>{let e="";if(O.value)e=O.value.fileId;else{let s=new Array;h.value.forEach(C=>{s.push(C.fileId)}),e=s.join(_.COMMON_SEPARATOR)}k.saveShareFiles({fileIds:e,targetParentId:a},s=>{s.code===0?(p.success("Saved successfully"),b.value=!1):s.code===10?(b.value=!1,z(),B()):p.error(s.message),c.value=!1})},Le=a=>_.getFileFontElement(a);return ha(()=>{va(),X(),z(),se.value=!1}),(a,e)=>{const s=ra,C=ee("DocumentCopy"),I=_a,i=ga,Me=ee("Download"),We=na,je=sa,He=ta,A=Ge,fe=la,Ke=Qe,pe=Ra,Z=ya,L=ea,me=aa,G=oa,Je=ee("Folder"),qe=Ze,Xe=Ye;return wa((f(),m("div",$a,[t("div",Oa,[t("div",za,[t("div",{class:"pan-share-header-title-font-content"},[t("span",{class:"pan-share-header-title-font",onClick:Ie},"R Pan")]),E.value?(f(),m("div",Ba,[o(s,{underline:!1,type:"success",class:"pan-share-username"},{default:l(()=>[u(" Welcome, "+v(N.value),1)]),_:1}),o(s,{underline:!1,type:"success",class:"pan-share-exit-button",onClick:Te},{default:l(()=>e[11]||(e[11]=[u(" Exit ")])),_:1})])):g("",!0),E.value?g("",!0):(f(),m("div",Aa,[o(s,{underline:!1,type:"primary",class:"pan-share-login-button",onClick:B},{default:l(()=>e[12]||(e[12]=[u(" Login ")])),_:1}),o(s,{underline:!1,type:"primary",class:"pan-share-register-button",href:"/register",target:"_blank"},{default:l(()=>e[13]||(e[13]=[u(" Register ")])),_:1})]))])]),t("div",La,[t("div",Ma,[o(pe,{shadow:"always",class:"pan-share-list-card"},{default:l(()=>[D.value?g("",!0):(f(),m("div",Wa,[t("div",ja,[t("span",Ha,v($.value),1),t("div",Ka,[t("span",Ja,[e[14]||(e[14]=t("i",{class:"fa fa-clock-o"},null,-1)),u("Share Date:"+v(te.value),1)]),t("span",qa,[e[15]||(e[15]=t("i",{class:"fa fa-clock-o"},null,-1)),u("Expire Date:"+v(K.value),1)])])]),t("div",Xa,[o(i,{type:"success",size:"default",round:"",onClick:e[0]||(e[0]=n=>ce(void 0))},{default:l(()=>[e[16]||(e[16]=u("Save to my drive ")),o(I,{class:"el-icon--right"},{default:l(()=>[o(C)]),_:1})]),_:1}),o(i,{type:"info",size:"default",round:"",onClick:$e},{default:l(()=>[e[17]||(e[17]=u("Download ")),o(I,{class:"el-icon--right"},{default:l(()=>[o(Me)]),_:1})]),_:1})]),o(We)])),D.value?(f(),m("div",Ya,e[18]||(e[18]=[t("span",null,"Sorry this share has expired or is no longer valid",-1)]))):g("",!0),D.value?g("",!0):(f(),m("div",Za,[t("div",Ga,[o(He,{"separator-class":"el-icon-arrow-right"},{default:l(()=>[(f(!0),m(Sa,null,Ea(T.value,(n,V)=>(f(),Va(je,{key:V},{default:l(()=>[t("a",{class:"breadcrumb-item-a",onClick:po=>Re(n.id),href:"#"},v(n.name),9,Qa)]),_:2},1024))),128))]),_:1})])])),D.value?g("",!0):(f(),m("div",eo,[o(Ke,{ref_key:"fileTableRef",ref:ge,data:H.value,height:Ee.value,"tooltip-effect":"dark",style:{width:"100%"},onSelectionChange:Ve,onCellMouseEnter:Pe,onCellMouseLeave:xe},{default:l(()=>[o(A,{type:"selection",width:"55"}),o(A,{label:"File Name",prop:"filename",sortable:"","show-overflow-tooltip":"","min-width":"750"},{default:l(n=>[t("div",{onClick:V=>Ue(n.row),class:"file-name-content"},[t("i",{class:U(Le(n.row.fileType)),style:{"margin-right":"15px","font-size":"20px",cursor:"pointer"}},null,2),t("span",oo,v(n.row.filename),1)],8,ao),t("div",lo,[o(fe,{class:"item",effect:"light",content:"Save to my drive",placement:"top"},{default:l(()=>[o(i,{type:"success",icon:"DocumentCopy",size:"small",circle:"",onClick:V=>ce(n.row)},null,8,["onClick"])]),_:2},1024),o(fe,{class:"item",effect:"light",content:"Download",placement:"top"},{default:l(()=>[o(i,{type:"info",icon:"Download",size:"small",circle:"",onClick:V=>ue(n.row)},null,8,["onClick"])]),_:2},1024)])]),_:1}),o(A,{prop:"fileSizeDesc",sortable:"",label:"Size","min-width":"120",align:"center"}),o(A,{prop:"updateTime",sortable:"",align:"center",label:"Update Time","min-width":"240"})]),_:1},8,["data","height"])]))]),_:1})])]),o(G,{title:"Welcome",modelValue:S.value,"onUpdate:modelValue":e[5]||(e[5]=n=>S.value=n),onOpened:ye,onClosed:we,width:"30%","append-to-body":"","modal-append-to-body":!1,center:""},{footer:l(()=>[t("span",so,[o(i,{onClick:e[4]||(e[4]=n=>S.value=!1)},{default:l(()=>e[19]||(e[19]=[u("Cancel")])),_:1}),o(i,{type:"primary",onClick:Y,loading:c.value},{default:l(()=>e[20]||(e[20]=[u("Confirm")])),_:1},8,["loading"])])]),default:l(()=>[t("div",null,[o(me,{"label-width":"100px",rules:ke,ref_key:"loginFormRef",ref:d,model:w,"status-icon":"",onSubmit:e[3]||(e[3]=he(()=>{},["prevent"]))},{default:l(()=>[o(L,{label:"Username",prop:"username"},{default:l(()=>[o(Z,{type:"text",ref_key:"usernameEl",ref:oe,onKeyup:ae(Y,["enter","native"]),modelValue:w.username,"onUpdate:modelValue":e[1]||(e[1]=n=>w.username=n),autocomplete:"off"},null,8,["modelValue"])]),_:1}),o(L,{label:"Password",prop:"password"},{default:l(()=>[o(Z,{type:"password","show-password":"",onKeyup:ae(Y,["enter","native"]),modelValue:w.password,"onUpdate:modelValue":e[2]||(e[2]=n=>w.password=n),autocomplete:"off"},null,8,["modelValue"])]),_:1})]),_:1},8,["rules","model"])])]),_:1},8,["modelValue"]),o(G,{modelValue:F.value,"onUpdate:modelValue":e[8]||(e[8]=n=>F.value=n),onOpened:Ce,onClosed:be,width:"30%",fullscreen:"","append-to-body":"","modal-append-to-body":!1,"close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1},{default:l(()=>[t("div",to,[t("div",no,[o(pe,{header:$.value,shadow:"always",class:"pan-share-code-card"},{default:l(()=>[o(me,{class:"pan-share-code-form",inline:"",rules:Se,ref_key:"shareCodeFormRef",ref:j,model:R,onSubmit:e[7]||(e[7]=he(()=>{},["prevent"]))},{default:l(()=>[o(L,{label:"Share Code",prop:"shareCode"},{default:l(()=>[o(Z,{type:"text",ref_key:"shareCodeEl",ref:le,onKeyup:ae(re,["enter","native"]),modelValue:R.shareCode,"onUpdate:modelValue":e[6]||(e[6]=n=>R.shareCode=n),autocomplete:"off"},null,8,["modelValue"])]),_:1}),o(L,null,{default:l(()=>[o(i,{type:"primary",loading:c.value,onClick:re},{default:l(()=>e[21]||(e[21]=[u("Confirm")])),_:1},8,["loading"])]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["header"])])])]),_:1},8,["modelValue"]),o(G,{title:"Save to my drive",modelValue:b.value,"onUpdate:modelValue":e[10]||(e[10]=n=>b.value=n),onOpen:ze,onClosed:Oe,width:"30%","append-to-body":"","modal-append-to-body":!1,center:""},{footer:l(()=>[t("span",uo,[o(i,{onClick:e[9]||(e[9]=n=>b.value=!1)},{default:l(()=>e[22]||(e[22]=[u("Cancel")])),_:1}),o(i,{type:"primary",onClick:Be,loading:c.value},{default:l(()=>e[23]||(e[23]=[u("Confirm")])),_:1},8,["loading"])])]),default:l(()=>[t("div",ro,[o(qe,{data:J.value,class:"tree","empty-text":"No folder data","default-expand-all":"","highlight-current":"","check-on-click-node":"","expand-on-click-node":!1,ref_key:"treeRef",ref:W},{default:l(({node:n,data:V})=>[t("span",io,[o(I,{size:20,style:{"margin-right":"15px",cursor:"pointer"}},{default:l(()=>[o(Je)]),_:1}),t("span",null,v(n.label),1)])]),_:1},8,["data"])])]),_:1},8,["modelValue"])])),[[Xe,se.value]])}}};export{Io as default};
